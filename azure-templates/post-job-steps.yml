# File: post-job-steps.yml
##### Steps Template After All Builds #####

# Inputs: pack
parameters:
  - name: buildOutputLocation
    type: string
  - name: archiveLocation
    type: string
  - name: pack
    type: boolean
    default: false

steps:
###########  Archive  ###########
  - ${{ if eq( parameters.pack, true )}}:
    - powershell: |
        rm -r "nipkg"
        mkdir "nipkg"
        cp -R "$(customDevice)\${{ parameters.buildOutputLocation }}\*" "nipkg\data\documents\National Instruments\NI VeriStand 2020\Custom Devices\National Instruments"
      displayName: Generate nipkg File structure (INCOMPLETE)
    - script: echo "this is incomplete"
      displayName: Pack nipkg (INCOMPLETE)
  - powershell: |
      Copy-Item `
      -Path "$(customDevice)\${{ parameters.buildOutputLocation }}\*" `
      -Destination "${{ parameters.archiveLocation }}\NI\export\$(Build.SourceBranchName)\$(Build.BuildId)\$(lvVersion)\$(architecture)\" `
      -Recurse
    displayName: Copying built files to nirvana Archive